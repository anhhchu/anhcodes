<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>How to recover lost files after a git reset --hard</title>

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

  <!-- Slick Carousel -->
  <link rel="stylesheet" href="https://anhcodes.dev/plugins/slick/slick.css" />
  <link rel="stylesheet" href="https://anhcodes.dev/plugins/slick/slick-theme.css" />
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://anhcodes.dev/plugins/font-awesome/css/font-awesome.min.css" />

  <!-- Magnific Popup -->
  <link rel="stylesheet" href="https://anhcodes.dev/plugins/magnafic-popup/magnific-popup.css" />

  <!-- Stylesheets -->
  
  <link href="https://anhcodes.dev/scss/style.min.css" rel="stylesheet" />

  <!--Favicon-->
  <link rel="shortcut icon" href="https://anhcodes.dev/images/favicon.ico" type="image/x-icon" />
  <link rel="icon" href="https://anhcodes.dev/images/favicon.png" type="image/x-icon" />
  
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-G09NWG7ZSN"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-G09NWG7ZSN');
  </script>
  <script src="https://cdn.jsdelivr.net/npm/instantsearch.js@4.37.1"></script>
  <script src="https://cdn.jsdelivr.net/npm/algoliasearch@4.11.0/dist/algoliasearch.umd.min.js"></script>
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.css@7.4.5/themes/satellite-min.css" integrity="sha256-TehzF/2QvNKhGQrrNpoOb2Ck4iGZ1J/DI4pkd2oUsBc=" crossorigin="anonymous">  
  
</head>

<body>
  <nav class="navbar navbar-expand-lg fixed-top">
  <div class="container">
    <a href="https://anhcodes.dev/" class="navbar-brand">
      <img src="https://anhcodes.dev/images/favicon.png" alt="site-logo">
    </a>
    <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#navbarCollapse">
      <span class="navbar-toggler-icon"></span>
      <span class="navbar-toggler-icon"></span>
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse justify-content-between" id="navbarCollapse">
      <ul class="nav navbar-nav main-navigation my-0 mx-auto">
        
        
        <li class="nav-item">
          <a href="https://anhcodes.dev/#home"
            class="nav-link text-dark text-sm-center p-2 ">Home</a>
        </li>
        
        <li class="nav-item">
          <a href="https://anhcodes.dev/#about"
            class="nav-link text-dark text-sm-center p-2 ">About</a>
        </li>
        
        <li class="nav-item">
          <a href="https://anhcodes.dev/#resume"
            class="nav-link text-dark text-sm-center p-2 ">Experiences</a>
        </li>
        
        <li class="nav-item">
          <a href="https://anhcodes.dev/#skills"
            class="nav-link text-dark text-sm-center p-2 ">Skills</a>
        </li>
        
        <li class="nav-item">
          <a href="https://anhcodes.dev/#testimonial"
            class="nav-link text-dark text-sm-center p-2 ">Testimonials</a>
        </li>
        
        <li class="nav-item">
          <a href="https://anhcodes.dev/#blog"
            class="nav-link text-dark text-sm-center p-2 ">Blog</a>
        </li>
        
      </ul>
      <div class="navbar-nav">
        <a href="https://anhcodes.dev/contact" class="btn btn-primary btn-zoom hire_button">Contact Me</a>
      </div>
    </div>
  </div>
</nav>
  <div id="content">
    

<header class="breadCrumb">
  <div class="container">
    <div class="row">
      <div class="col-lg-10 col-md-12 offset-lg-1 offset-md-0 text-center">
        <h3 class="breadCrumb__title">How to recover lost files after a git reset --hard</h3>
        <nav aria-label="breadcrumb" class="d-flex justify-content-center">
          <ol class="breadcrumb align-items-center">
            <li class="breadcrumb-item"><a href=https://anhcodes.dev/>Home</a></li>
            <li class="breadcrumb-item"><a href=https://anhcodes.dev/blog>All Posts</a></li>
            <li class="breadcrumb-item"><a href=https://anhcodes.dev//tags>All Tags</a></li>
          </ol>
        </nav>
      </div>
    </div>

    <ul class="post-meta">
      <li>
        <i class="fa fa-calendar"></i>
        December 27, 2022
      </li>
      <li>
        <i class="fa fa-clock-o"></i>
        3 mins read
      </li>
      <li>
        <i class="fa fa-user"></i>
        Anh Chu
      </li>
    </ul>
    <ul class="post-meta">
      </li>
      
      <li>
        <i class="fa fa-tag"></i>
        
          <a class="text-lowercase" href="https://anhcodes.dev/tags/git/">git</a>
        
      </li>
      
    </ul>
  </div>
  </div>
  </div>
  </div>
</header>

<section class="section singleBlog">
  <div class="svg-img">
    <img src=https://anhcodes.dev/images/hero/hero-background-svg.svg alt="">
  </div>
  <div class="animate-shape">
    <img src=https://anhcodes.dev/images/skill/skill-background-shape.svg alt="">
  </div>
  <div class="container">
    <div class="row">
      <div class="col-lg-12">
        <div class="singleBlog__feature">
          <img src=https://anhcodes.dev/images/single-blog/git-reset/github-reset.png alt="feature-image">
          <center><figcaption style="font-size: 10px; margin-top: 20px;">  </figcaption></center>
        </div>
      </div>
    </div>
    <div class="row mt-5">
      <div class="col-lg-12">
        <div class="singleBlog__content">

          

          <p>While working on a recent project, I accidentally committed some files. Instead of using <code>git reset --soft &lt;prev-commit-id&gt;</code> to unstage them, I used <code>git reset --hard HEAD</code> and all of my new changes gone with the wind. After panicking for a few minutes, I determined to learn how <code>git reset</code> works and how I can revert the damages.</p>
<h3 id="1-what-is-git-reset-hard-vs-soft">1. What is git reset (hard vs soft)</h3>

<div class="image">
  <style>
    .img-responsive {
      display: block;
      height: auto;
      max-width: 100%;
      cursor: pointer;
    }
  </style>
  <p>
    <center><img src="https://anhcodes.dev/images/single-blog/git-reset/git-reset.png" alt="blog-img" class="img-responsive" onclick="openModal(this)"></center>
  </p>
</div>

<script>
function openModal(img) {
  var modal = document.createElement('div');
  modal.classList.add('modal');
  modal.innerHTML = '<div class="modal-content"><img src="' + img.src + '"></div>';
  document.body.appendChild(modal);
  modal.addEventListener('click', closeModal);
}

function closeModal(event) {
  if (event.target.classList.contains('modal')) {
    document.body.removeChild(event.target);
  }
}
</script>

<style>
.modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.7);
  display: flex;
  justify-content: center;
  align-items: center;
}

.modal-content {
  max-width: 80%;
  max-height: 80%;
  overflow: auto;
}

.modal-content img {
  width: 100%;
  height: auto;
}
</style>

  
<p><code>git reset --hard</code> resets the current branch tip, and also deletes any changes in the working directory and staging area (although files under <code>git stash</code> will not be affected). It resets index entries to a specified commit, or the HEAD location. <code>git reset --hard</code> should be used with caution, since it can lead to losing work in your staging area and working directory.</p>
<p>Below is the demonstration of what happened to a new file <code>test2.txt</code> after a <code>git reset --hard</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#433e56;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>  $ git status
</span></span><span style="display:flex;"><span>  On branch master
</span></span><span style="display:flex;"><span>  Untracked files:
</span></span><span style="display:flex;"><span>    <span style="color:#ffb8d1">(</span>use <span style="color:#1bc5e0">&#34;git add &lt;file&gt;...&#34;</span> to include in what will be committed<span style="color:#ffb8d1">)</span>
</span></span><span style="display:flex;"><span>          test2.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  $ git add test2.txt
</span></span><span style="display:flex;"><span>  On branch master
</span></span><span style="display:flex;"><span>  Changes to be committed:
</span></span><span style="display:flex;"><span>    <span style="color:#ffb8d1">(</span>use <span style="color:#1bc5e0">&#34;git restore --staged &lt;file&gt;...&#34;</span> to unstage<span style="color:#ffb8d1">)</span>
</span></span><span style="display:flex;"><span>          new file:   test2.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  $ git commit -m <span style="color:#1bc5e0">&#34;Add test2&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ffb8d1">[</span>master 2d7949d<span style="color:#ffb8d1">]</span> Add test2
</span></span><span style="display:flex;"><span>  <span style="color:#c5a3ff">1</span> file changed, <span style="color:#c5a3ff">10</span> insertions<span style="color:#ffb8d1">(</span>+<span style="color:#ffb8d1">)</span>
</span></span><span style="display:flex;"><span>  create mode <span style="color:#c5a3ff">100644</span> test2.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  $ git reset --hard 6122c04
</span></span><span style="display:flex;"><span>  HEAD is now at 6122c04 add test
</span></span></code></pre></div><p>After doing the <code>get reset --hard</code> to commit id 6122c04, the file test2 will be removed from the working directory</p>
<p>On the contrary, <code>git reset --soft</code> revert your commit without removing your files from the working directory. After that you can unstage the files you don&rsquo;t want to commit</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#433e56;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>  $ git status
</span></span><span style="display:flex;"><span>  On branch master
</span></span><span style="display:flex;"><span>  Untracked files:
</span></span><span style="display:flex;"><span>    <span style="color:#ffb8d1">(</span>use <span style="color:#1bc5e0">&#34;git add &lt;file&gt;...&#34;</span> to include in what will be committed<span style="color:#ffb8d1">)</span>
</span></span><span style="display:flex;"><span>          test2.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  $ git add test2.txt
</span></span><span style="display:flex;"><span>  On branch master
</span></span><span style="display:flex;"><span>  Changes to be committed:
</span></span><span style="display:flex;"><span>    <span style="color:#ffb8d1">(</span>use <span style="color:#1bc5e0">&#34;git restore --staged &lt;file&gt;...&#34;</span> to unstage<span style="color:#ffb8d1">)</span>
</span></span><span style="display:flex;"><span>          new file:   test2.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  $ git commit -m <span style="color:#1bc5e0">&#34;Add test2&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ffb8d1">[</span>master 2d7949d<span style="color:#ffb8d1">]</span> Add test2
</span></span><span style="display:flex;"><span>  <span style="color:#c5a3ff">1</span> file changed, <span style="color:#c5a3ff">10</span> insertions<span style="color:#ffb8d1">(</span>+<span style="color:#ffb8d1">)</span>
</span></span><span style="display:flex;"><span>  create mode <span style="color:#c5a3ff">100644</span> test2.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  $ git reset --soft 6122c04
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  $ git status
</span></span><span style="display:flex;"><span>  On branch master
</span></span><span style="display:flex;"><span>  Changes to be committed:
</span></span><span style="display:flex;"><span>    <span style="color:#ffb8d1">(</span>use <span style="color:#1bc5e0">&#34;git restore --staged &lt;file&gt;...&#34;</span> to unstage<span style="color:#ffb8d1">)</span>
</span></span><span style="display:flex;"><span>          new file:   test2.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  $ git restore --staged test2.txt 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  $ git status
</span></span><span style="display:flex;"><span>  On branch master
</span></span><span style="display:flex;"><span>  Untracked files:
</span></span><span style="display:flex;"><span>    <span style="color:#ffb8d1">(</span>use <span style="color:#1bc5e0">&#34;git add &lt;file&gt;...&#34;</span> to include in what will be committed<span style="color:#ffb8d1">)</span>
</span></span><span style="display:flex;"><span>          test2.txt
</span></span></code></pre></div><h3 id="2-recover-files-after-git-reset---hard-in-3-scenarios">2. Recover files after <code>git reset --hard</code> in 3 scenarios</h3>
<h4 id="scenario-1-changes-committed">Scenario 1: Changes committed</h4>
<p>If you do a <code>git reset --hard</code> after <code>git add</code> and <code>git commit</code></p>
<ol>
<li>
<p>retrace the commit that you need to recover</p>
<p><code>git reflog</code></p>
</li>
<li>
<p>switch to the commit you want to recover, now your repo will be in &lsquo;detached HEAD&rsquo; state</p>
<p><code>git checkout &lt;commit-id&gt;</code></p>
</li>
<li>
<p>to fix the detached HEAD state, create a new branch and merge the branch back to master</p>
<p><code>git branch &lt;new-branch&gt; &lt;commit-id&gt;</code></p>
<p><code>git checkout master</code></p>
<p><code>git merge &lt;new-branch&gt;</code></p>
</li>
</ol>
<h4 id="scenario-2-changes-staged-but-not-yet-committed">Scenario 2: Changes staged but not yet committed</h4>
<p>If you do a <code>git reset --hard</code> after <code>git add</code> but before <code>git commit</code></p>
<ol>
<li>
<p>Use <code>git fsck</code> to check dangling blob hash id (blob that has no commits associated to it). This will help us retrieve the content of the files that were staged but not yet committed</p>
</li>
<li>
<p><code>git show &lt;dangling blob id&gt; &gt; recover.txt</code> to send the content of the blob to a file</p>
</li>
<li>
<p>Another option is to use <code>git fsck --lost-found</code> to move all the dangling blobs to lost-found directory. Then, <code>cd .git/lost-found/other</code> to check all the dangling blob content</p>
</li>
</ol>
<h4 id="scenario-3-changes-not-staged-nor-committed">Scenario 3: Changes not staged nor committed</h4>
<p>If you do a <code>git reset --hard</code> after <code>git add</code> and <code>git commit</code>, your new changes before staging will still be in your directory.</p>

        </div>
      </div>
    </div>
  </div>
</section>


  </div>
  <section class="footer" id="contact">
	<div class="footer__background_shape">
		<svg viewBox="0 0 1920 79">
			<path d="M0 0h1920v79L0 0z" data-name="Path 1450" />
		</svg>
	</div>
	<div class="container">
		<div class="row">
			<div class="col-lg-12">
				<div class="footer__cta">
					<div class="shape-1">
						<svg xmlns="http://www.w3.org/2000/svg" width="357" height="315.029" viewBox="0 0 357 315.029">
							<path data-name="Path 1449"
								d="M76.1-157.222C91.746-135.8 87.2-94.273 99.993-61.945c12.7 32.328 42.661 55.459 39.248 73.282-3.318 17.823-40.007 30.337-65.6 43.325-25.5 12.988-39.912 26.545-60.01 42.566-20.1 16.116-46.074 34.6-63.328 27.682-17.349-6.921-25.976-39.153-59.915-59.82s-93.1-29.768-105.325-51.478 22.373-56.028 43.609-93.949c21.331-37.921 29.2-79.35 53.563-96.793 24.459-17.444 65.414-10.9 103.9-6.921 38.396 3.982 74.326 5.404 89.965 26.829z"
								transform="translate(217.489 188.626)" />
						</svg>
					</div>
					<div class="shape-2">
						<svg xmlns="http://www.w3.org/2000/svg" width="357" height="315.029" viewBox="0 0 357 315.029">
							<path data-name="Path 1449"
								d="M76.1-157.222C91.746-135.8 87.2-94.273 99.993-61.945c12.7 32.328 42.661 55.459 39.248 73.282-3.318 17.823-40.007 30.337-65.6 43.325-25.5 12.988-39.912 26.545-60.01 42.566-20.1 16.116-46.074 34.6-63.328 27.682-17.349-6.921-25.976-39.153-59.915-59.82s-93.1-29.768-105.325-51.478 22.373-56.028 43.609-93.949c21.331-37.921 29.2-79.35 53.563-96.793 24.459-17.444 65.414-10.9 103.9-6.921 38.396 3.982 74.326 5.404 89.965 26.829z"
								transform="translate(217.489 188.626)" />
						</svg>
					</div>
					<div class="text-light footer__cta_content">
						<span>Contact me</span>
						<h2 class="mb-0">Let’s Work Together</h2>
					</div>
					<div class="footer__cta_action">
						<a class="btn btn-light btn-zoom" href="https://anhcodes.dev/contact">Get in
							touch</a>
					</div>
				</div>
			</div>
		</div>
		
			
			
		<div class="row footer__footer">
			<div class="col-lg-6">
				<div class="footer__footer_copy text-light">
					<p>©2023 - Made with ☕, Hugo, and Firebase by <a class="text-light" href="https://anhcodes.dev/" target="_blank">Anh Chu</a></p>
				</div>
			</div>
			<div class="col-lg-6">
				<div class="footer__footer_social">
					<ul class="unstyle-list">
						
						
						<li class="d-inline-block mx-2"><a class="text-light" target="_blank" href="https://dev.to/anhcodes"><i
									class="fa fa-code"></i></a>
						</li>
						
						<li class="d-inline-block mx-2"><a class="text-light" target="_blank" href="https://www.linkedin.com/in/anhhchu/"><i
									class="fa fa-linkedin-square"></i></a>
						</li>
						
						<li class="d-inline-block mx-2"><a class="text-light" target="_blank" href="https://github.com/anhhchu"><i
									class="fa fa-github-square"></i></a>
						</li>
						
					</ul>
				</div>
			</div>
		</div>
	</div>
</section>

<script src="https://anhcodes.dev/plugins/jQuery/jquery.min.js"></script>
<script src="https://anhcodes.dev/plugins/bootstrap/bootstrap.min.js"></script>
<script src="https://anhcodes.dev/plugins/slick/slick.min.js"></script>
<script src="https://anhcodes.dev/plugins/waypoint/jquery.waypoints.min.js"></script>
<script src="https://anhcodes.dev/plugins/magnafic-popup/jquery.magnific-popup.min.js"></script>
<script src="https://anhcodes.dev/plugins/tweenmax/TweenMax.min.js"></script>
<script src="https://anhcodes.dev/plugins/imagesloaded/imagesloaded.min.js"></script>
<script src="https://anhcodes.dev/plugins/masonry/masonry.min.js"></script>


<script src="https://anhcodes.dev/js/script.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/instantsearch.js@4.37.1"></script>
<script src="https://cdn.jsdelivr.net/npm/algoliasearch@4.11.0/dist/algoliasearch.umd.min.js"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.css@7.4.5/themes/satellite-min.css" integrity="sha256-TehzF/2QvNKhGQrrNpoOb2Ck4iGZ1J/DI4pkd2oUsBc=" crossorigin="anonymous">  

</body>

</html>